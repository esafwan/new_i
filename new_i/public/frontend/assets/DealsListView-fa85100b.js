import{m as g,h as x,i as V,s as R,j as N,k as P,r as h,b as t,c as r,d as n,w as d,u as c,F as $,f as S,g as m,n as y,l as f,p as T,e as j,t as B}from"./index-29a91f62.js";import{_ as q,H as F,a as H,b as O,c as E,d as J,e as G}from"./ListBulkActions-8ddaba3b.js";import{_ as K}from"./statuses-cf7e371a.js";import{I as Q}from"./IndicatorIcon-2e26ac17.js";import{P as X}from"./PhoneIcon-df7b879a.js";import{_ as Y}from"./ListRows-f2bc9a56.js";import{b as M,_ as Z}from"./global-7d1669ca.js";import{D as ee}from"./Dropdown-a48e38bc.js";import{_ as te}from"./ListFooter-96a0f786.js";const se={key:0,class:"flex items-center"},le={key:0},oe={key:1},ae={key:2},ne={key:3},ie={key:4},re=["onClick"],de={key:1,class:"truncate text-base"},ue={key:2},ce=["onClick"],he={__name:"DealsListView",props:g({rows:{type:Array,required:!0},columns:{type:Array,required:!0},options:{type:Object,default:()=>({selectable:!0,showTooltip:!0,resizeColumn:!1,totalCount:0,rowCount:0})}},{modelValue:{},modelModifiers:{},list:{},listModifiers:{}}),emits:g(["loadMore","updatePageCount","columnWidthUpdated","applyFilter","applyLikeFilter","likeDoc"],["update:modelValue","update:list"]),setup(a,{expose:z,emit:L}){const u=L,p=x(a,"modelValue"),_=x(a,"list"),A=V(()=>{var i,o;return!!((o=(i=_.value.params)==null?void 0:i.filters)!=null&&o._liked_by)}),{user:D}=R();function w(i){if(i)return JSON.parse(i).includes(D)}N(p,(i,o)=>{i!==o&&u("updatePageCount",i)});const C=P(null);return z({customListActions:V(()=>{var i;return(i=C.value)==null?void 0:i.customListActions})}),(i,o)=>{const v=h("Button"),U=h("Badge"),I=h("FormControl");return t(),r($,null,[n(c(J),{class:y(i.$attrs.class),columns:a.columns,rows:a.rows,options:{getRowRoute:s=>({name:"Deal",params:{dealId:s.name}}),selectable:a.options.selectable,showTooltip:a.options.showTooltip,resizeColumn:a.options.resizeColumn},"row-key":"name"},{default:d(()=>[n(c(q),{class:"sm:mx-5 mx-3",onColumnWidthUpdated:o[1]||(o[1]=s=>u("columnWidthUpdated"))},{default:d(()=>[(t(!0),r($,null,S(a.columns,s=>(t(),m(c(H),{key:s.key,item:s,onColumnWidthUpdated:l=>u("columnWidthUpdated",s)},{default:d(()=>[s.key=="_liked_by"?(t(),m(v,{key:0,variant:"ghosted",class:y(["!h-4",A.value?"fill-red-500":"fill-white"]),onClick:o[0]||(o[0]=()=>u("applyLikeFilter"))},{default:d(()=>[n(F,{class:"h-4 w-4"})]),_:1},8,["class"])):f("",!0)]),_:2},1032,["item","onColumnWidthUpdated"]))),128))]),_:1}),n(Y,{rows:a.rows},{default:d(({idx:s,column:l,item:e,row:W})=>[l.key==="_assign"?(t(),r("div",se,[n(K,{avatars:e,size:"sm",onClick:b=>u("applyFilter",{event:b,idx:s,column:l,item:e,firstColumn:a.columns[0]})},null,8,["avatars","onClick"])])):(t(),m(c(O),{key:1,item:e},{prefix:d(()=>[l.key==="status"?(t(),r("div",le,[n(Q,{class:y(e.color)},null,8,["class"])])):l.key==="organization"?(t(),r("div",oe,[e.label?(t(),m(c(M),{key:0,class:"flex items-center",image:e.logo,label:e.label,size:"sm"},null,8,["image","label"])):f("",!0)])):l.key==="deal_owner"?(t(),r("div",ae,[e.full_name?(t(),m(c(M),{key:0,class:"flex items-center",image:e.user_image,label:e.full_name,size:"sm"},null,8,["image","label"])):f("",!0)])):l.key==="mobile_no"?(t(),r("div",ne,[n(X,{class:"h-4 w-4"})])):l.key==="_liked_by"?(t(),r("div",ie,[l.key=="_liked_by"?(t(),m(v,{key:0,variant:"ghosted",class:y(w(e)?"fill-red-500":"fill-white"),onClick:T(()=>u("likeDoc",{name:W.name,liked:w(e)}),["stop","prevent"])},{default:d(()=>[n(F,{class:"h-4 w-4"})]),_:2},1032,["class","onClick"])):f("",!0)])):f("",!0)]),default:d(({label:b})=>[["modified","creation","first_response_time","first_responded_on","response_by"].includes(l.key)?(t(),r("div",{key:0,class:"truncate text-base",onClick:k=>u("applyFilter",{event:k,idx:s,column:l,item:e,firstColumn:a.columns[0]})},[n(c(Z),{text:e.label},{default:d(()=>[j("div",null,B(e.timeAgo),1)]),_:2},1032,["text"])],8,re)):l.key==="sla_status"?(t(),r("div",de,[e.value?(t(),m(U,{key:0,variant:"subtle",theme:e.color,size:"md",label:e.value,onClick:k=>u("applyFilter",{event:k,idx:s,column:l,item:e,firstColumn:a.columns[0]})},null,8,["theme","label","onClick"])):f("",!0)])):l.type==="Check"?(t(),r("div",ue,[n(I,{type:"checkbox",modelValue:e,disabled:!0,class:"text-gray-900"},null,8,["modelValue"])])):(t(),r("div",{key:3,class:"truncate text-base",onClick:k=>u("applyFilter",{event:k,idx:s,column:l,item:e,firstColumn:a.columns[0]})},B(b),9,ce))]),_:2},1032,["item"]))]),_:1},8,["rows"]),n(c(E),null,{actions:d(({selections:s,unselectAll:l})=>[n(c(ee),{options:C.value.bulkActions(s,l)},{default:d(()=>[n(v,{icon:"more-horizontal",variant:"ghost"})]),_:2},1032,["options"])]),_:1})]),_:1},8,["class","columns","rows","options"]),p.value?(t(),m(c(te),{key:0,class:"border-t sm:px-5 px-3 py-2",modelValue:p.value,"onUpdate:modelValue":o[2]||(o[2]=s=>p.value=s),options:{rowCount:a.options.rowCount,totalCount:a.options.totalCount},onLoadMore:o[3]||(o[3]=s=>u("loadMore"))},null,8,["modelValue","options"])):f("",!0),n(G,{ref_key:"listBulkActionsRef",ref:C,modelValue:_.value,"onUpdate:modelValue":o[4]||(o[4]=s=>_.value=s),doctype:"CRM Deal"},null,8,["modelValue"])],64)}}};export{he as _};
//# sourceMappingURL=DealsListView-fa85100b.js.map
